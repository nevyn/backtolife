<template name="game">
  <div id="game">
    <p><a href="{{pathFor 'home'}}">Home</a></p>
    <h1>Game: {{game.name}}</h1>
    <div>Turn: {{game.turnNr}}</div>
    <div>Teams:
      <ul>
        {{#each teams}}
          <li>{{name}}
            {{#if isItOurTurn}}
              (TURN)
            {{/if}}
          </li>
        {{/each}}
      </ul>
    </div>
    <div>
      {{#with myTeam}}
        {{#if isItOurTurn}}
          <button id="end-turn">End turn</button>
        {{/if}}
      {{/with}}
    </div>

    <div>
    {{#each myCharacters}}
      <div class="character">
        <h3>{{name}}</h3>
        <div>HP: {{getHitPoints}}</div>
        <div>Mana: {{getMana}}</div>
        <div>Stamina: {{getStamina}}</div>
        <div>Damage: {{getDamage}}</div>
        <div>Magic resistance: {{getMagicResistance}}</div>
        <ul>
          {{#each arrayify attributes}}
            <li>{{key}}: {{value}}</li>
          {{/each}}
        </ul>
        {{#each abilities}}
        <button
          class="ability"
          data-ability="{{this}}"
          data-character="{{../_id}}">{{this}}</button>
        {{/each}}
      </div>
    {{/each}}
    </div>


    <h2 class="clear">Events</h2>
    <ul>
      {{#each game.events}}
      <li>{{getCharacterName character}}: {{state}} {{ability}}</li>
      {{/each}}
    </ul>
  </div>
</template>
